"use strict";(self["webpackChunkCloudRenderManager"]=self["webpackChunkCloudRenderManager"]||[]).push([[915],{9302:function(e,t,s){s.d(t,{Z:function(){return c}});var i=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{visible:e.isConfirm,"before-close":e.handleClose,"close-on-click-modal":!1,width:"400px","show-close":!1},on:{"update:visible":function(t){e.isConfirm=t}}},[t("div",{staticClass:"el-dialog-content"},[t("div",{staticClass:"dialog-header"},[t("span"),t("svg-icon",{attrs:{"icon-class":"close"},on:{click:e.handleClose}})],1),t("div",{staticClass:"content"},[e._v("此操作将删除该条记录, 是否继续?")]),t("div",{staticClass:"dialog-btn"},[t("div",{on:{click:e.handleClose}},[e._v("取消")]),t("div",{on:{click:e.handle}},[e._v("继续")])])])])],1)},a=[],n={name:"Confirm",props:{isConfirm:{type:Boolean,default:()=>!1}},methods:{handleClose(){this.$emit("close")},handle(){this.$emit("definite")}}},l=n,o=s(1001),r=(0,o.Z)(l,i,a,!1,null,"13d8392f",null),c=r.exports},7915:function(e,t,s){s.r(t),s.d(t,{default:function(){return g}});var i=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"opration"},[t("div",{staticClass:"search-nomal"},[t("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.searchKey,callback:function(t){e.searchKey=t},expression:"searchKey"}}),t("div",{staticClass:"search-nomal-btn"},[e._v("搜索")])],1),t("div",{staticClass:"opration-add",on:{click:function(t){e.dialogVisible=!0}}},[t("svg-icon",{attrs:{"icon-class":"add"}}),e._v(" 添加 ")],1)]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.load,expression:"load"}],staticStyle:{width:"100%"},attrs:{"element-loading-background":"rgba(0, 0, 0, 0.2)",data:e.tableData,height:e.tableHigh}},[t("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"}}),t("el-table-column",{attrs:{prop:"projectName",label:"项目名称",width:"200",align:"center"}}),t("el-table-column",{attrs:{label:"实例ID",align:"center"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("div",{staticClass:"copy-id"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.instId,expression:"instId"}],ref:"copyInput",staticStyle:{opacity:"0",width:"10px"},attrs:{type:"text"},domProps:{value:e.instId},on:{input:function(t){t.target.composing||(e.instId=t.target.value)}}}),e._v(" "+e._s(JSON.parse(s.row.renderconfig).instId)+" "),t("svg-icon",{attrs:{"icon-class":"copy"},on:{click:function(t){return e.copyText(s.row.renderconfig)}}})],1)]}}])}),t("el-table-column",{attrs:{label:"启动配置",align:"center"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("span",{staticStyle:{"margin-right":"20px"}},[e._v("质量："+e._s(Number(JSON.parse(s.row.renderconfig).encoderMaxQP))+" QP")]),t("span",[e._v("最大刷新率："+e._s(JSON.parse(s.row.renderconfig).maxFps)+" FPS")])]}}])}),t("el-table-column",{attrs:{prop:"createDate",label:"创建时间",width:"240",align:"center"}}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"240"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("div",{staticClass:"opra"},[t("span",{on:{click:function(t){return e.delHandle(s.row.id)}}},[t("svg-icon",{attrs:{"icon-class":"del"}}),e._v("删除 ")],1),t("span",{staticStyle:{"margin-left":"10px"},on:{click:function(t){return e.editHandle(s.row)}}},[t("svg-icon",{attrs:{"icon-class":"edit"}}),e._v("编辑 ")],1),t("span",{staticStyle:{"margin-left":"10px"},on:{click:function(t){return e.runHandle(s.row)}}},[t("svg-icon",{attrs:{"icon-class":"run"}}),e._v(e._s(s.row.run?"关闭":"启动")+" ")],1),s.row.run?t("span",{staticStyle:{"margin-left":"10px"},on:{click:function(t){return e.RevHandle(s.row)}}},[t("svg-icon",{attrs:{"icon-class":"bof"}})],1):e._e()])]}}])})],1),t("el-dialog",{attrs:{visible:e.dialogVisible,width:"472px","show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{staticClass:"el-dialog-content"},[t("div",{staticClass:"dialog-header"},[t("span",[e._v("添加实例")]),t("svg-icon",{attrs:{"icon-class":"close"},on:{click:function(t){e.dialogVisible=!1}}})],1),t("el-form",{ref:"formRef",attrs:{model:e.form,rules:e.formRules,"hide-required-asterisk":"","label-position":"top"}},[t("el-form-item",{attrs:{label:"项目名称",prop:"ProjectID"}},[t("div",{staticClass:"input-box"},[t("el-select",{attrs:{disabled:e.form.hasOwnProperty("id")},model:{value:e.form.ProjectID,callback:function(t){e.$set(e.form,"ProjectID",t)},expression:"form.ProjectID"}},e._l(e.proOptions,(function(e){return t("el-option",{key:e.projectId,attrs:{label:e.projectName,value:e.projectId}})})),1)],1)]),t("el-form-item",{attrs:{label:"质量",prop:"encoderMaxQP"}},[t("slider",{attrs:{max:50,min:5,step:5,normal:e.form.encoderMaxQP},on:{setVal:function(t){return e.getVal(t,"encoderMaxQP")}}})],1),t("el-form-item",{attrs:{label:"最大刷新率",prop:"maxFps"}},[t("div",{staticClass:"radio"},[t("div",{class:{"is-radio":30==e.form.maxFps},on:{click:function(t){return e.fpsClick(30)}}},[e._v(" 30帧 ")]),t("div",{class:{"is-radio":60==e.form.maxFps},on:{click:function(t){return e.fpsClick(60)}}},[e._v(" 60帧 ")])])])],1),t("div",{staticClass:"dialog-btn"},[t("div",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),t("div",{on:{click:function(t){return e.submit("formRef")}}},[e._v("确认")])])],1)]),t("confirm",{attrs:{"is-confirm":e.confirm},on:{close:e.close,definite:e.isConfirm}})],1)},a=[],n=s(9935),l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"slider"},[t("el-slider",{attrs:{"show-tooltip":!1,step:e.step,min:e.min,max:e.max,"show-stops":""},model:{value:e.val,callback:function(t){e.val=t},expression:"val"}}),t("div",{staticClass:"slider-input"},[t("el-input",{attrs:{oninput:"value=value.replace(/[^0-9.]/g,'')"},model:{value:e.val,callback:function(t){e.val=e._n(t)},expression:"val"}}),t("div",{staticClass:"slider-btn"},[t("div",{on:{click:e.plus}},[t("svg-icon",{attrs:{"icon-class":"plus"}}),e._v(" "),t("svg-icon",{attrs:{"icon-class":"plus-sel"}})],1),t("div",{on:{click:e.cut}},[t("svg-icon",{attrs:{"icon-class":"cut"}}),e._v(" "),t("svg-icon",{attrs:{"icon-class":"cut-sel"}})],1)])],1)],1)},o=[],r={name:"Slider",props:{step:{type:Number,default:()=>1},min:{type:Number,default:()=>0},max:{type:Number,default:()=>1},normal:{type:[Number,String,Boolean],default:()=>1}},data(){return{val:0,isInitialized:!1}},watch:{val(e){this.isInitialized?this.$emit("setVal",e):this.isInitialized=!0}},mounted(){this.val=this.normal},methods:{plus(){this.val+=this.step},cut(){this.val-=this.step}}},c=r,d=s(1001),u=(0,d.Z)(c,l,o,!1,null,"b0c14e10",null),p=u.exports,m=s(9302),f={components:{Slider:p,Confirm:m.Z},data(){return{encodeOptions:["ConstQP","VBR","CBR"],searchKey:"",tableHigh:null,tableData:[],proOptions:[],dialogVisible:!1,confirm:!1,delId:[],instId:"",load:!1,form:{encoderMaxQP:35,maxFps:30},formRules:{ProjectID:[{required:!0,message:" ",trigger:"blur"}],encoderRateControl:[{required:!0,message:" ",trigger:"blur"}]}}},watch:{dialogVisible(e){e||(this.form={encoderMaxQP:35,maxFps:30})}},mounted(){let e=document.querySelector(".el-table");this.tableHigh=e.clientHeight-51,this.getProjectList(),this.getList()},methods:{fpsClick(e){this.$set(this.form,"maxFps",e)},getList(){n.getAllInstance().then((e=>{0==e.code&&(this.tableData=e.data)}))},getProjectList(){n.getAllProject().then((e=>{0==e.code&&(this.proOptions=e.data)}))},getVal(e,t){this.form[t]=e},submit(e){this.$refs[e].validate((e=>{if(!e)return console.log("error submit!!"),!1;this.form.id?n.UpdateInstance(this.form).then((e=>{0==e.code&&(this.$message.success("启动参数修改成功"),this.getList(),this.dialogVisible=!1)})):n.AddInstance(this.form).then((e=>{0==e.code&&(this.$message.success("添加项目成功"),this.getList(),this.dialogVisible=!1)}))}))},close(){this.confirm=!1},editHandle(e){this.dialogVisible=!0,this.form={id:e.id,ProjectID:e.projectid,maxFps:Number(JSON.parse(e.renderconfig).maxFps),encoderMaxQP:Number(JSON.parse(e.renderconfig).encoderMaxQP)},console.log(this.form)},delHandle(e){this.delId=[e],this.confirm=!0},isConfirm(){console.log(this.delId),n.delInstance(this.delId).then((e=>{0==e.code&&(this.$message.success("删除成功"),this.getList(),this.confirm=!1)}))},runHandle(e){this.load=!0;let t=e.run?"killInstance":"runInstance",s=e.run?"关闭":"成功";n[t](e.id).then((e=>{0==e.code&&(this.$message.success(`已${s}`),this.getList()),this.load=!1})).catch((()=>{this.load=!1}))},RevHandle(e){window.open(`${window.location.origin}/player/#/?ws=ws://${window.location.hostname}:${e.previewUrl}&insid=${e.id}`)},copyText(e){this.instId=JSON.parse(e).instId;const t=this.$refs.copyInput;t.value=this.instId,t.select(),document.execCommand("copy"),t.value="",this.$message.info("实例ID已复制到剪切板")}}},h=f,v=(0,d.Z)(h,i,a,!1,null,"53e3968f",null),g=v.exports}}]);